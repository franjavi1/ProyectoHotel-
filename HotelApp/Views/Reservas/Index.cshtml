<style>
    
    .header-title {
        color: #5a6b7a;
        font-weight: 700;
    }

    
    .btn-custom-primary {
        background-color: #5a6b7a !important;
        border: none;
        color: #fff;
        transition: all 0.3s ease;
        font-weight: 600;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

        .btn-custom-primary:hover {
            background-color: #ff7b00 !important; 
            color: #fff;
            transform: scale(1.02);
        }

    
    .btn-outline-action {
        border-color: #5a6b7a;
        color: #5a6b7a;
        transition: all 0.2s ease;
    }

        .btn-outline-action:hover {
            background-color: #5a6b7a;
            color: #fff;
        }

    
    .precio-total-col {
        font-weight: 700;
        color: #ff7b00; 
    }

    
    .table-container-card {
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        overflow: hidden; 
    }
</style>
@model IEnumerable<HotelApp.Models.Reserva>

@{
    ViewData["Title"] = "Reservas";
}


<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" />
<link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap5.min.css" />
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600&display=swap" rel="stylesheet">



<div class="d-flex justify-content-between align-items-center mb-4 mt-3">
    <h2 class="header-title m-0 d-flex align-items-center">
        <i class="fa-solid fa-calendar-check me-3 fs-3"></i>
        Listado de Reservas
    </h2>
    <a asp-action="Create" class="btn btn-custom-primary btn-lg">
        <i class="fa-solid fa-plus me-2"></i> Nueva Reserva
    </a>
</div>

<hr class="mb-5" style="border-top: 2px solid #ff7b00; width: 100px; margin-left: 0;">



<div class="table-container-card bg-white">
    <table id="reservasTable" class="table table-striped table-hover responsive nowrap" style="width:100%">
        <thead>
            <tr>
                <th>@Html.DisplayNameFor(model => model.Huesped)</th>
                <th>Habitación</th>
                <th>Empleado</th>
                <th>@Html.DisplayNameFor(model => model.FechaEntrada)</th>
                <th>@Html.DisplayNameFor(model => model.FechaSalida)</th>
                <th class="text-end">@Html.DisplayNameFor(model => model.PrecioTotal)</th>
                <th class="text-center">@Html.DisplayNameFor(model => model.Pagado)</th>
                <th class="text-center">Acciones</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>@Html.DisplayFor(modelItem => item.Huesped.Apellido), @Html.DisplayFor(modelItem => item.Huesped.Nombre)</td>
                    <td>@Html.DisplayFor(modelItem => item.Habitacion.Numero)</td>
                    <td>@Html.DisplayFor(modelItem => item.Empleado.Email)</td>
                    <td>@item.FechaEntrada.ToString("yyyy-MM-dd")</td>
                    <td>@item.FechaSalida.ToString("yyyy-MM-dd")</td>
                    <td class="text-end precio-total-col">@String.Format("{0:C}", item.PrecioTotal)</td>
                    
                    <td class="text-center">@(item.Pagado ? "Sí" : "No")</td>

                    <td class="text-center text-nowrap">
                        <!-- Check In/Out -->
                        @if (item.Status == 1)
                        {
                            <!-- Pendiente de check-in -->
                            <a asp-action="Check" asp-route-id="@item.Id" class="btn btn-sm btn-success me-1">
                                <i class="fa-solid fa-door-open"></i> Check-in
                            </a>
                        }
                        else if (item.Status == 2)
                        {
                            <!-- Ya hizo check-in, mostrar check-out -->
                            <a asp-action="Check" asp-route-id="@item.Id" class="btn btn-sm btn-warning me-1">
                                <i class="fa-solid fa-door-closed"></i> Check-out
                            </a>
                        }
                        else if (item.Status == 3)
                        {
                            <!-- Ya hizo check-out, mostrar revertir -->
                            <a asp-action="Check" asp-route-id="@item.Id" class="btn btn-sm btn-warning me-1">
                                <i class="fa-person-walking-arrow-loop-left"></i> Revertir
                            </a>
                        }
                        <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-outline-action" title="Editar Reserva">
                            <i class="fa-solid fa-pen"></i>
                        </a>
                        <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-sm btn-outline-action" title="Ver Detalles">
                            <i class="fa-solid fa-eye"></i>
                        </a>
                        <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-sm btn-outline-danger" title="Eliminar Reserva">
                            <i class="fa-solid fa-trash-can"></i>
                        </a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>


@section Scripts {
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap5.min.js"></script>

    <script>
        (function () {
            $(document).ready(function () {
                $('#reservasTable').DataTable({
                    responsive: true,
                    language: {
                        url: 'https://cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json'
                    },
                    order: [[3, 'desc']], 
                    columnDefs: [
                        {
                            targets: 6, 
                            className: 'text-center',
                            
                            render: function (data, type, row) {
                                var d = (data || '').toString().toLowerCase();
                                
                                if (d === 'sí' || d === 'si' || d === 'true') {
                                    return '<span class="badge rounded-pill bg-success text-white px-3 py-2">Pagado</span>';
                                }
                                return '<span class="badge rounded-pill bg-danger text-white px-3 py-2">Pendiente</span>';
                            }
                        },
                        {
                            targets: 5, 
                            className: 'text-end precio-total-col', 
                        },
                        {
                            targets: -1, 
                            orderable: false,
                            searchable: false,
                            className: 'text-center text-nowrap' 
                        }
                    ]
                });
            });
        })();
    </script>
}